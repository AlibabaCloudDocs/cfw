# 云防火墙最佳实践

本文从版本选择、开启资产保护、配置访问控制策略等方面提供指导。

-   [开启公网资产保护](#section_npg_seh_1ju)
-   [开启VPC资产保护](#section_uer_vr5_tpg)
-   [开启云防火墙保护和入侵防御拦截模式](#section_ajk_fqg_c7z)
-   [云防火墙数据库防御最佳实践](/cn.zh-CN/最佳实践/云防火墙数据库防御最佳实践.md)
-   [云防火墙保护堡垒机最佳实践](/cn.zh-CN/最佳实践/云防火墙保护堡垒机最佳实践.md)
-   [云防火墙防御挖矿蠕虫最佳实践](/cn.zh-CN/最佳实践/云防火墙防御挖矿蠕虫最佳实践.md)

## 如何选择适合我的云防火墙版本

云防火墙分为高级版、企业版和旗舰版三个版本，每个版本支持的功能和资产/带宽扩展规格不同，详细信息参见[功能特性](/cn.zh-CN/产品简介/功能特性.md)。

## 开启公网资产保护

互联网边界防火墙帮助您检测和防护云上公网IP资产间的通信流量。只有为资产开启互联网边界防火墙后，您才可以使用云防火墙分析和控制云上主机的互联网访问流量。

您可以在[云防火墙控制台](https://yundun.console.aliyun.com/?p=cfwnext)的**互联网边界防火墙**页面，对指定的公网IP资产开启互联网边界防火墙。

![选择管理](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5246298951/p32275.png)

## 开启VPC资产保护

VPC边界防火墙能够检测和统计已连通的VPC间的通信流量数据，帮助您发现和排查异常攻击。开启VPC边界防火墙之前，您需要先创建VPC边界防火墙。

步骤说明如下：

1.  在[云防火墙控制台](https://yundun.console.aliyun.com/?p=cfwnext)的**VPC边界防火墙**页面，选择为云企业网实例或高速通道实例创建VPC边界防火墙。

    ![云企业网未配置](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1100129951/p72469.png)

2.  为云企业网实例或高速通道实例开启VPC边界防火墙。

    ![VPC实例开关](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/9246298951/p59034.png)


## 开启云防火墙保护和入侵防御拦截模式

云防火墙服务开通后，您可在**防火墙开关**页面将资产**一键全部开启保护**，在**入侵防御**页面中开启**拦截模式**，即可全面保护您的资产安全。

## 配置外到内的访问策略

在外-内流量的访问策略中，不要对公网IP全部端口开放访问，对外仅开放必要的互联网IP和端口，其他端口请全部设置为**拒绝**。

1.  放行需要对外开放的应用或端口。

    在**访问控制**页面**外-内流量**列表中，依据业务需求，将源IP地址配置为`0.0.0.0/0`或特定源，也可选择地址簿中系统默认配置的地址簿**ANY**（`0.0.0.0/0`）或特定源，目的选择要放开的IP或地址簿中的特定目的，协议选择**ANY**或者依据业务需要选择对应协议，动作选择**放行**。

    ![](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/5839997951/p35632.png)

    示例：

    80端口为Web服务，对全网开放，因此访问源为0.0.0.0/0；1433、3389端口分别为SqlServer、RDP服务，对特定源开放，因此访问源为特定源。

2.  将除放行策略之外的流量设置为拒绝放行。

    在**访问控制**页面**外-内流量**列表中，将源IP地址配置为`0.0.0.0/0`或地址簿中系统默认配置的地址簿**ANY**（`0.0.0.0/0`），目的设置为**ANY**，协议设置为**ANY**，动作选择**拒绝**。


## 配置内到外的访问策略

**内-外流量**建议不要开放全部放行的策略，只对到必要的外部IP或域名的访问开启放行，其他访问全部设置为**拒绝**。

1.  放行需要对外访问的应用或端口。

    在**访问控制**页面**内-外流量**列表中，依据业务需求，将源IP地址配置为`0.0.0.0/0`或特定源，也可选择地址簿中系统默认配置的地址簿**ANY**（`0.0.0.0/0`）或特定源，目的选择要放开的域名或IP或地址簿中的特定目的，协议选择ANY或者依据业务需要选择对应协议，动作选择放行。

2.  将除放行策略之外的流量设置为**拒绝**放行。

    在访问控制页面内-外流量列表中，将源IP地址配置为`0.0.0.0/0`或选择地址簿中系统默认配置的地址簿**ANY**（`0.0.0.0/0`），目的设置为ANY，协议设置为ANY，动作选择**拒绝**。


